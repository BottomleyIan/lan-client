<div class="flex flex-row gap-4">
  <app-task-icon [task]="entryState() ?? entry()" />
  <div class="flex-1">
    @if (isEditing()) {
      <div class="flex flex-col gap-3" [formGroup]="editForm">
        <label class="text-sm font-semibold text-slate-100" [for]="rawInputId()">
          Edit entry
        </label>
        <textarea
          uiInput
          [id]="rawInputId()"
          rows="6"
          formControlName="raw"
          [attr.aria-invalid]="
            editForm.controls.raw.invalid && editForm.controls.raw.touched ? true : null
          "
          [disabled]="isSaving()"
        ></textarea>
        @if (editForm.controls.raw.invalid && editForm.controls.raw.touched) {
          <p class="text-xs font-semibold text-rose-200">Entry is required.</p>
        }
        <div class="flex justify-end gap-2">
          <app-icon-button-danger
            icon="x"
            [label]="'Cancel edit for ' + label()"
            [disabled]="isSaving()"
            (pressed)="cancelEdit()"
          />
          <app-icon-button-primary
            icon="check"
            [label]="'Save entry ' + label()"
            [disabled]="editForm.invalid || isSaving()"
            (pressed)="saveEdit()"
          />
        </div>
      </div>
    } @else {
      <app-markdown-body [markdown]="body()"></app-markdown-body>
    }
  </div>
  @if (!isEditing()) {
    <app-icon-button-primary
      icon="notesAdd"
      [label]="'Edit entry ' + label()"
      [disabled]="false"
      (pressed)="startEdit()"
    />
    <app-icon-button-danger
      icon="trash"
      [label]="'Delete entry ' + label()"
      [disabled]="false"
      (pressed)="onDelete()"
    />
  }
</div>
